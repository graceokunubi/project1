<html>

    <head> 
        <title> Data Cleaning </title>
        <script src="https://d3js.org/d3.v6.min.js"></script>
    </head>

    <script>

        d3.csv("./approval_polllist.csv", d3.autoType)
            .then( (data) => { 

                //Note from Emily Lin: I have converted dates from string to date format, filtered dates 
                //so that only those between 1/1/2020 and 1/1/2021 show up 
                
                console.log(data); 

                //string date format 1/23/2017
                const dateParser = d3.timeParse("%m/%d/%Y");
                data.forEach( d => {
                    d['createddate'] = dateParser(d["createddate"]); //we can use this date as the proxy date for the visualization
                    d['enddate'] = dateParser(d["enddate"]);
                    d['modeldate'] = dateParser(d["modeldate"]); //seems to be date when data model created; probably irrelevant 
                    d['startdate'] = dateParser(d["startdate"]);
                });

                // const createdDateExtent = d3.extent(data, d => d['createddate'] );
                // console.log(createdDateExtent);
                // // min: Mon Jan 23 2017
                // // max: Wed Jan 20 2021

                data = data.filter( (d) => {return (d['createddate'] >= new Date("1/1/2020")) && (d['createddate'] < new Date("1/1/2021")) ;}  );
                data.sort( (a,b) => d3.ascending(a['createddate'], b['createddate'])); 
                
                console.log(data);


                
                //next steps: filter out data we don't need? i.e. url, poll_id, question_id, etc. 
            

        }); 

    </script>

</html>